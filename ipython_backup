#!/usr/bin/env bash

# ================================================================================
# =                                IPYTHON_BACKUP                                =
# ================================================================================

# Backup IPython configuration to dual restic repositories
# - Backs up to local Pi (R1) and cloud B2 (R2)
# - Prunes old snapshots, keeping last 1

set -euo pipefail

# Backup
restic -r "$R1" backup ~/.ipython/profile_default/ipython_config.py --tag ipython
restic -r "$R2" backup ~/.ipython/profile_default/ipython_config.py --tag ipython

# Prune
restic -r "$R1" forget --tag ipython --keep-last 1 --prune
restic -r "$R2" forget --tag ipython --keep-last 1 --prune

echo "IPython backup completed successfully"
